# QA / Acceptance Skill - 你在验收时必须知道的系统背景

以下是你在测试时需要牢牢记住的产品现状和关键结构。不需要写代码，但要知道这些词的含义，方便判断哪里断了。

-------------------------------------------------
1. 登录 / 会员 / 配额
- 用户用手机号+验证码登录。
- 会员=有本月配额（例如100次）并在有效期内。
- 每次创建任务会先预扣配额1次。
- 如果任务失败（AI挂了、内容违规、超时），后端会自动返还那1次。
- 如果任务成功完成，配额不会返还。
- 非会员/配额耗尽的账号，不应该能继续创建高成本任务。

你在验收时，一定要去看这个数字有没有被正确扣/返。

-------------------------------------------------
2. 两类任务
- 同步任务（例：服装清理增强）
  → 处理图像用腾讯数据万象（数据万象/CI）
  → 几秒钟内出结果
  → /task/create 返回就已经有 resultUrls，status=done 或 failed
  → 不需要轮询

- 异步任务（例：AI模特12分镜）
  → 由后端+SCF Worker+RunningHub一起完成
  → /task/create 先返回 status=processing
  → 前端轮询 GET /task/:id，等 status 变成 done 或 failed
  → 最终再拿 resultUrls（通常12张）
  → 失败则配额返还

你验收时要根据 PRD 判断：这个新功能属于哪一类？
同步=应该立刻出结果；异步=应该有状态"processing→done"。

如果 PRD 说"同步"，但实际要我等 2 分钟轮询，那是 🔴。
如果 PRD 说"异步"，但前端压根没轮询直接白屏，那也是 🔴。

-------------------------------------------------
3. 工作台（用户入口）
工作台通常包含：
- 会员卡片（剩余次数 / 到期日）
- 功能卡列表（例如"服装清理增强""AI模特12分镜"）
- 最近任务历史列表

如果新功能应该出现在工作台，比如"促销海报生成"，你要确认：
- 新卡片真的出现了
- 非会员点击是否会提示"去开会员"
- 会员点击是否能进表单页

如果卡片根本没出现，或者任何人都能点开高成本功能 → 🔴。

-------------------------------------------------
4. 表单页
表单页一般做三件事：
- 上传媒体（通过 STS 直传 COS，而不是直接把图传给后端大文件）
- 用户填参数（比如：风格、价格、slogan、类型）
- 调用 /task/create 创建任务

你要确认：
- 上传有没有实际成功（前端是否拿到了 COS 上传成功的地址）
- /task/create 请求是不是被发起了
- 返回有没有 taskId
- 错误信息是否清晰（不是一串堆栈）

如果创建任务失败但用户不懂发生了什么（比如直接"Internal Server Error"），这对验收来说是 🔴（老板无法演示）。

-------------------------------------------------
5. 任务详情页
任务详情页展示：
- 任务状态（processing / done / failed）
- 如果 done，展示 resultUrls 图片
- 如果 failed，展示 errorReason 给人类看的话术（比如"生成失败，请重试，次数已返还"）
- 对异步任务：详情页应该在轮询刷新状态

你在验收时必须去看：
- 任务状态有没有正确显示
- 失败时有没有清楚地告诉用户"已返还次数"
- 对成功任务，结果图是不是能点开/预览（哪怕缩略图）

如果结果出来了但前端不展示，那老板没法演示 → 🔴。

-------------------------------------------------
6. 我们的品牌视觉要求
Reviewer Skill 会最终审视觉一致性，但你也要初步看：
- 页面不是默认丑后台（灰白表格），而是我们既定风格：深色/玻璃/高奢时装感/霓虹强调。
- 新功能的卡片别一眼看上去像完全不是同一产品。

如果异样严重（像是套的免费管理后台模板），请在报告里写"外观疑似不符合主风格，建议 Reviewer 二次确认"，但这不是你一票否决的理由，除非视觉导致功能不可用（比如白字白底看不清）。

-------------------------------------------------
7. 你交付的对象是谁
- 你直接面向 Reviewer Skill 和 CodeBuddy Deploy Skill。
- 你的报告告诉 Reviewer："可以/不可以批准这版作为 demo"。
- 你的报告告诉 CodeBuddy Deploy："可以/不可以推到老板机器，给老板亲手点"。
- 如果你标为 🔴，Deploy Skill 不该发这版到线上环境。

总结：你是老板的防雷层。