# 我们现在的线上拓扑（以本项目为准）

你（CodeBuddy Deploy Skill）需要对当前架构有清晰、统一的理解。现在不是大型集群，而是 MVP 上线的简化版：

1. 腾讯云 CVM（云服务器）
   - 跑我们的"后端服务"（Node.js / Next.js API Routes）
   - 也可以直接承载 SSR 的前端，或者静态前端由 Nginx 代理
   - 这个机器已经绑定了域名，比如 api.xxx.com
   - 这是老板现在的"线上环境"

2. COS + 数据万象（CI）
   - `input/{userId}/{taskId}/...` 放用户上传的原图
   - CI（数据万象）做同步图像处理（抠图/白底/增强）
   - 处理后的图、最终结果图放在 `output/{userId}/{taskId}/...`
   - 这些路径是我们前后端约定好的，不要乱动
   - 桶不对全网公开；访问要么内网，要么后端签URL

3. SCF Worker（腾讯云云函数）
   - 用于"长时间/大资源/AI工作流"的任务，例如多分镜模特、视频生成
   - 流程：
     a. 它从 COS 读原图/视频
     b. 它调 RunningHub 之类的外部AI工作流
     c. 它把生成的结果图/视频写回 COS `output/...`
     d. 它向后端的 `/internal/task/update` POST 回调（带签名），告诉后端"这个任务完成/失败，结果在这些URL"
   - 注意：SCF 不改配额，也不直接面向用户

4. 前端工作台
   - 展示会员次数、创建任务、展示任务详情
   - 它访问的是我们后端公开接口，比如 `/task/create`、`/task/:id`、`/membership/status`
   - 它永远不能访问 `/internal/task/update`
   - 它永远不能拿到 RunningHub 的内部 apiKey

5. 发布节奏
   - 我们是"边开发边上机调试"的策略
   - 所以我们允许把最新代码直接推到这台 CVM，然后老板立刻打开浏览器做真实体验
   - 这意味着你（Deploy Skill）就是现场的运维+发版+回滚管理员

你的任务不是重构架构，而是让这一套在现实的腾讯云里活着，并且随时可以热更新，从而让老板测试新想法。