# BuildingAI Sidecar 环境变量配置
# 艹，这个配置文件包含BuildingAI侧车的所有环境变量！
# ⚠️ 注意：这个文件包含敏感信息，不要提交到Git！

# =============================================================================
# 数据库配置（连接宿主机MySQL）
# =============================================================================
DB_HOST=host.docker.internal
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=your_mysql_password_here
DB_DATABASE=ai_photo

# =============================================================================
# Redis配置（使用独立DB隔离）
# =============================================================================
REDIS_HOST=host.docker.internal
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=1
REDIS_KEY_PREFIX=ba:

# =============================================================================
# JWT配置
# =============================================================================
JWT_SECRET=your_jwt_secret_here_min_32_chars_random_string
JWT_EXPIRES_IN=7d

# =============================================================================
# 管理员账号配置（首次启动时创建）
# ⚠️ 重要：首次启动后立即修改密码！
# =============================================================================
ADMIN_EMAIL=admin@buildingai.local
ADMIN_PASSWORD=Change_Me_Immediately_123!

# =============================================================================
# AI Provider配置（可选）
# =============================================================================
# OpenAI
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_BASE_URL=https://api.openai.com/v1

# Anthropic Claude
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_BASE_URL=https://api.anthropic.com

# 国产大模型（可选）
# TONGYI_API_KEY=
# WENXIN_API_KEY=

# =============================================================================
# 应用配置
# =============================================================================
LOG_LEVEL=info
CORS_ORIGIN=http://localhost:3000,https://aizhao.icu
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000

# =============================================================================
# 功能开关
# =============================================================================
ENABLE_FRONTEND=false
ENABLE_MCP=true
ENABLE_RAG=true
ENABLE_BILLING=true

# =============================================================================
# 📝 配置说明
# =============================================================================
#
# 1. DB_PASSWORD - 必须修改
#    你的MySQL root密码，或者创建专用账号
#
# 2. JWT_SECRET - 必须修改
#    生成随机字符串：node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 3. ADMIN_PASSWORD - 必须修改
#    BuildingAI管理员密码，首次启动后立即修改
#    要求：至少8位，包含大小写字母、数字、特殊字符
#
# 4. AI Provider Keys - 可选
#    如果需要使用OpenAI/Anthropic，填写对应API Key
#    不填写则需要通过BuildingAI管理界面配置
#
# 5. Redis隔离
#    REDIS_DB=1: 使用DB1（主应用用DB0）
#    REDIS_KEY_PREFIX=ba:: Key前缀隔离
#
# 6. CORS配置
#    添加你的前端域名到CORS_ORIGIN
#
# =============================================================================
# 🚨 安全检查清单
# =============================================================================
#
# ✅ 1. DB_PASSWORD已修改为强密码
# ✅ 2. JWT_SECRET已生成随机字符串（至少32字符）
# ✅ 3. ADMIN_PASSWORD已修改为强密码
# ✅ 4. 本文件已添加到.gitignore
# ✅ 5. API Keys不要提交到Git
# ✅ 6. 生产环境使用环境变量注入
#
# =============================================================================
# 🔧 首次启动步骤
# =============================================================================
#
# 1. 修改上述必需配置项
# 2. 确保MySQL和Redis在运行
# 3. 启动服务：
#    cd deploy/buildingai
#    docker-compose --env-file ../../.env.buildingai up -d
#
# 4. 等待2-3分钟（首次启动需初始化数据库）
# 5. 验证服务：
#    curl http://localhost:4090/health
#
# 6. 修改管理员密码：
#    登录BuildingAI后台 → 个人设置 → 修改密码
#
# =============================================================================
# 📊 故障排查
# =============================================================================
#
# - 启动失败：
#   docker-compose logs -f buildingai-server
#
# - 数据库连接失败：
#   检查DB_HOST、DB_PASSWORD是否正确
#   确保MySQL允许Docker容器连接
#
# - Redis连接失败：
#   检查REDIS_HOST、REDIS_PORT是否正确
#
# - 内存不足：
#   调整docker-compose.yml中的resources.limits
#
# =============================================================================
